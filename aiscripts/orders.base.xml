<?xml version="1.0" encoding="utf-8"?>
<diff>

  <!-- Prevent undocking for GalaxyTrader DockAndTrain orders -->
  <add sel="//aiscript[@name='orders.base']/attention/actions/do_if[@value='$undock?']" pos="before">
    <do_if value="@$undock and (($object.order.id == 'DockAndTrain') or ($object.order.id == 'DockAndWait' and @$object.order.$callerid.id == 'DockAndTrain'))">
      <remove_value name="$undock"/>
      <do_if value="@global.$GT_GlobalSettings.$Debug.$EnableDebugLogging">
        <debug_text text="'[GT_TRAINING PATCH] Preventing undock for DockAndTrain order on ship: ' + $object.knownname" chance="if $object.isplayerowned then 100 else 0"/>
      </do_if>
    </do_if>
  </add>

</diff> 